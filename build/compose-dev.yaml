name: app-template-dev
services:
  redis:
    extends:
      file: compose.yaml
      service: redis
    volumes: !override
      - redis_data_dev:/data
    networks: !override [ app-template-dev ]

  db:
    extends:
      file: compose.yaml
      service: db
    volumes: !override
      - pg_data_dev:/var/lib/postgresql/data
    networks: !override [ app-template-dev ]

  minio:
    extends:
      file: compose.yaml
      service: minio
    volumes: !override
      - minio_data_dev:/data
    networks: !override [ app-template-dev ]

  backend:
    image: app-template-backend:latest-dev
    build:
      context: ../
      dockerfile: ./build/docker/Dockerfile.dev
    env_file: !override
      - ./configs/envs/.env.dev
    extends:
      file: compose.yaml
      service: backend
    networks: !override [ app-template-dev ]
    develop:
      watch: !override
        - action: sync
          path: backend
          target: /app
          ignore:
            - .git
            - vendor

volumes:
  pg_data_dev:
  minio_data_dev:
  redis_data_dev:

networks:
  app-template-dev:
    name: app-template-dev
